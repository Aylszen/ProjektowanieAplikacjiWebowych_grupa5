<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trelo</title>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/angular-dragula/1.2.8/dragula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-dragula/1.2.8/angular-dragula.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
 
</head>
<body ng-app="myApp" ng-controller="Ctrl">
<div>
     <form ng-submit="AddTable()">
        <input type="type" name="" ng-model="InputAdd" placeholder="Add New Table">
        <input type="submit" name="Add New Table" value="Add table">
        {{tableList}}
     </form>
    <div ng-repeat="y in tableList"
         style="background-color:#E6E6FA">
        <h2>{{y.tableText}}</h2>
        <form ng-submit="AddTicket(y,text)" >
            <input type="type" name="" ng-model="text"  placeholder="Add New">
             <input type="submit" name="Add New" value="Add item"> 
        </form>
         <br>
        <div 
        dragula='"bag-one"'
         dragula-model="y.ticket"
         dragula-scope="$parent"
         style="background-color: #cccccc">

            <div ng-repeat="x in y.ticket" >
                <input type="checkbox" ng-model="x.done"> <span ng-bind="x.text"></span> 
            </div>
         </div>    
    </div>
</div>
 
<script type="text/javascript">
    var app = angular.module("myApp", [angularDragula(angular)]);
    app.controller("Ctrl", function($scope){
          $scope.tableList = [
            {tableText: "todo",
                ticket: [
                    {text: "first", done: false},
                    {text: "second", done: false}
                        ] 
            },
            {tableText: "inprogress",
                ticket:[
                    {text: "third", done: false}
                        ]    
            },
            {tableText: "Done",
                ticket:[
                    {text:"next",done:false}
                ]
            }]

        
        $scope.AddTicket = function(tT,text){
         tT.ticket.push({text: this.text, done: false});
             this.text = "";
        }
        $scope.remove = function(){
            var oldList = $scope.tableList;
            $scope.tableList = [];
            angular.forEach(oldList, function(x){
                if(!x.done) $scope.tableList.push(x);
            })
        }
        $scope.AddTable = function(){
            $scope.tableList.push({tableText: $scope.InputAdd, ticket:  [{text: "lol"}]});
            $scope.InputAdd="";
        }
        $scope.annoy = function(){
            alert("annoy!")
        }

    });
    </script>
</body>
</html>